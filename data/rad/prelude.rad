(do
  ;; ref functions ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

  (def modify-ref
    (fn [r f]
      (write-ref r (f (read-ref r)))))

  ;; revisions ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

  (def revisions (ref (dict)))

  (def create-revision
    (fn [rev]
      (do
        (modify-ref revisions (fn [rs] (insert (lookup :id rev) rev rs)))
        :ok
      )))
)
